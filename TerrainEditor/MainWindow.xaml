<Controls:MetroWindow  x:Class="TerrainEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TerrainEditor"
        xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:dialogs="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
        xmlns:h="http://helix-toolkit.org/wpf"
        xmlns:viewModels="clr-namespace:TerrainEditor.ViewModels"
        xmlns:localControls="clr-namespace:TerrainEditor.UserControls"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:pt="http://propertytools.org/wpf"
        mc:Ignorable="d"
        GlowBrush="Black"
        Title="Terrain Editor" Width="1024" Height="768" TitleCaps="False" WindowState="Maximized">


    <Controls:MetroWindow.DataContext>
        <viewModels:TerrainEditorDataContext/>
    </Controls:MetroWindow.DataContext>
    <DockPanel>
        <Menu DockPanel.Dock="Top" Background="{StaticResource WindowBackgroundBrush}">
            <MenuItem Header="File">
                <MenuItem Header="New Project..." />
                <MenuItem Header="Open Project..." />
                <Separator/>
                <MenuItem Header="Save" />
                <MenuItem Header="Save As" />
                <MenuItem Header="Export" />
                <Separator/>
                <MenuItem Header="Exit"/>
            </MenuItem>
            <MenuItem Header="Edit">
                <MenuItem Header="Undo" />
                <MenuItem Header="Redo" />
                <Separator/>
                <MenuItem Header="Cut"  />
                <MenuItem Header="Copy" />
                <MenuItem Header="Paste" />
                <Separator/>
                <MenuItem Header="Find..." />
                <MenuItem Header="Replace..." />
                <MenuItem Header="Go To..." />
            </MenuItem>
            <MenuItem Header="View"/>
            <MenuItem Header="Project"/>
            <MenuItem Header="Help"/>
        </Menu>
        <ToolBarTray  DockPanel.Dock="Top"   >
            <ToolBar ToolBarTray.IsLocked="False" >
                <Button Width="25" Height="25" Margin="2" ToolTip="New Project"  >
                    <Image Source="icons/new.png" Stretch="Fill"/>
                </Button>

                <Button Width="25" Height="25" Margin="2" ToolTip="Open Project"  >
                    <Image Source="icons/open.png" Stretch="Fill"/>
                </Button>
                <Button Width="25" Height="25" Margin="2" ToolTip="Save Project"   >
                    <Image Source="icons/save.png" Stretch="Fill"/>
                </Button>
                <Separator/>
                <Button Width="25" Height="25" Margin="2" ToolTip="Add Terrain"  >
                    <Image Source="icons/add.png" Stretch="Fill"/>
                </Button>
                <Button Width="20" Height="20" Margin="2" ToolTip="Remove Terrain"  >
                    <Image Source="icons/minus.png" Stretch="Fill"/>
                </Button>
            </ToolBar>
        </ToolBarTray>
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock Text="Status Bar"/>
            </StatusBarItem>
        </StatusBar>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="3*"/>
                <RowDefinition Height="5"/>
                <RowDefinition MaxHeight="250"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition MaxWidth="350"/>
            </Grid.ColumnDefinitions>
            
            <GridSplitter Grid.Row="1" VerticalAlignment="Stretch"  HorizontalAlignment="Stretch" ResizeDirection="Rows"/>
            <GridSplitter Grid.Row="0" Grid.Column="1" Grid.RowSpan="3" VerticalAlignment="Stretch"  HorizontalAlignment="Stretch" ResizeDirection="Columns"/>

            <h:HelixViewport3D
                Name="HelixViewport3D"
                Grid.Row="0" Grid.Column="0" 
                Background="#252525"
                CalculateCursorPosition="True"
                CameraMode="WalkAround"
                IsRotationEnabled="False"
                ShowViewCube="False"
                CameraRotationMode="Turntable">

                <h:HelixViewport3D.Camera>
                    <PerspectiveCamera LookDirection="0,0,-30" UpDirection="0,1,0" Position="0,0,25" NearPlaneDistance="0.01" FarPlaneDistance="Infinity" FieldOfView="61"/>
                </h:HelixViewport3D.Camera>

                <h:SunLight Ambient="1"/>
                <h:GridLinesVisual3D Fill="Gray" Thickness="0.08"/>
                
                <ModelVisual3D >
                    <ModelVisual3D.Content>
                        <Model3DGroup Children="{Binding TerrainsMeshes}" />
                    </ModelVisual3D.Content>
                </ModelVisual3D>

                <localControls:VertexManipulator 
                    Source="{Binding SelectedTerrain}" 
                    InputSource="{Binding ElementName=HelixViewport3D}"/>

            </h:HelixViewport3D>


            <!--<pt:ColorPicker Grid.Column="2" VerticalAlignment="Center" SelectedColor="Red"  />-->
            
            <pt:PropertyGrid Grid.Column="2" Grid.RowSpan="3" Grid.Row="0" SelectedObject="{Binding SelectedTerrain}" ShowDescriptionIcons="False" TabVisibility="Visible"  >
                <pt:PropertyGrid.Resources>
                    <SolidColorBrush x:Key="HeaderBackgroundBrush" Color="{StaticResource AccentColor}" />

                    <LinearGradientBrush x:Key="SelectionBrush" StartPoint="0,0" EndPoint="0,1">
                        <LinearGradientBrush.GradientStops>
                            <GradientStop Offset="0" Color="#3F3F46" />
                            <GradientStop Offset="1" Color="#252526" />
                        </LinearGradientBrush.GradientStops>
                    </LinearGradientBrush>
                    <LinearGradientBrush x:Key="SelectionBrush2" StartPoint="0,0" EndPoint="0,1">
                        <LinearGradientBrush.GradientStops>
                            <GradientStop Offset="0" Color="#3F3F46" />
                            <GradientStop Offset="1" Color="#252526" />
                        </LinearGradientBrush.GradientStops>
                    </LinearGradientBrush>

                    <Style TargetType="pt:DataGrid">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type pt:DataGrid}">
                                    <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                        <Grid x:Name="PART_Grid">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="{TemplateBinding ColumnHeaderHeight}" />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="{TemplateBinding RowHeaderWidth}" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <!-- The grid cell area (sheet) -->
                                            <ScrollViewer x:Name="PART_SheetScrollViewer" Focusable="False" Grid.Row="1" Grid.Column="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                                <Grid x:Name="PART_SheetGrid" Background="Transparent" Cursor="/PropertyTools.Wpf;component/DataGrid/Cursors/Cross.cur">
                                                    <Border x:Name="PART_SelectionBackground" Background="#3F3F46" />
                                                    <Border x:Name="PART_CurrentBackground" Background="Transparent" />
                                                    <Border x:Name="PART_Selection" BorderBrush="Black" BorderThickness="3" Margin="-1,-1,-2,-2" />
                                                    <Border x:Name="PART_AutoFillSelection" BorderBrush="Gray" BorderThickness="3" Margin="-1,-1,-2,-2" Visibility="Hidden" />
                                                    <Border x:Name="PART_AutoFillBox" Width="7" Height="7" SnapsToDevicePixels="True" Cursor="/PropertyTools.Wpf;component/DataGrid/Cursors/AutoFill.cur" HorizontalAlignment="Right" VerticalAlignment="Bottom" Background="Black" BorderBrush="White" BorderThickness="1" Margin="0, 0, -4, -4" />
                                                </Grid>
                                            </ScrollViewer>
                                            <!-- Column headers -->
                                            <ScrollViewer x:Name="PART_ColumnScrollViewer" Grid.Row="0" Grid.Column="1" VerticalScrollBarVisibility="Hidden"
                            HorizontalScrollBarVisibility="Hidden">
                                                <Grid x:Name="PART_ColumnGrid" Cursor="/PropertyTools.Wpf;component/DataGrid/Cursors/DownArrow.cur"
                      Background="{StaticResource HeaderBackgroundBrush}">
                                                    <Border x:Name="PART_ColumnSelectionBackground" Background="{StaticResource SelectionBrush}" />
                                                </Grid>
                                            </ScrollViewer>
                                            <!-- Row headers -->
                                            <ScrollViewer x:Name="PART_RowScrollViewer" Grid.Row="1" Grid.Column="0" VerticalScrollBarVisibility="Hidden"
                            HorizontalScrollBarVisibility="Hidden">
                                                <Grid x:Name="PART_RowGrid" Cursor="/PropertyTools.Wpf;component/DataGrid/Cursors/RightArrow.cur"
                      Background="{StaticResource HeaderBackgroundBrush}">
                                                    <Border x:Name="PART_RowSelectionBackground" Background="{StaticResource SelectionBrush2}" />
                                                </Grid>
                                            </ScrollViewer>
                                            <!-- The top-left cell -->
                                            <Grid Grid.Row="0" Grid.Column="0">
                                                <Border x:Name="PART_TopLeft" Cursor="/PropertyTools.Wpf;component/DataGrid/Cursors/Cross.cur"
                        Background="{StaticResource HeaderBackgroundBrush}" BorderBrush="#b1b5ba" BorderThickness="1,1,1,1" Margin="0,0,0,0">
                                                    <Path Data="F1 M0,11 L11,11 L11,0 z" Fill="#30000000" HorizontalAlignment="Right"
                        VerticalAlignment="Bottom" Margin="3" />
                                                </Border>
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </pt:PropertyGrid.Resources>
            </pt:PropertyGrid>

        </Grid>
        
    </DockPanel>
</Controls:MetroWindow>



